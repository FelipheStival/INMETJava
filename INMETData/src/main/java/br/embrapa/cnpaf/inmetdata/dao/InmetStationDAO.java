package br.embrapa.cnpaf.inmetdata.dao;

import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.List;

import org.apache.log4j.Level;

import br.embrapa.cnpaf.inmetdata.entity.InmetCityEntily;
import br.embrapa.cnpaf.inmetdata.entity.InmetStationEntity;
import br.embrapa.cnpaf.inmetdata.enumerate.MessageEnum;
import br.embrapa.cnpaf.inmetdata.exception.PersistenceException;
import br.embrapa.cnpaf.inmetdata.util.NetworkUtil;
import br.embrapa.cnpaf.inmetdata.util.TimeUtil;

/**
 * <br>
 * <p>
 * <b> Singleton Class responsible for by performing the persistence of entities
 * of the type InmetHourlyDataEntity.</b>
 * </p>
 * <p>
 * It uses the standard Data Access Object design - DAO, in order to separate
 * the other system classes the code needed to interface with the database. For
 * this it defines the methods save, delete, find and list to persist or
 * retrieve the entities.
 * </p>
 * <p>
 * To retrieve an instance of this class use the static method getInstanceOf
 * ():<br>
 * <br>
 * &nbsp;&nbsp;&nbsp;&nbsp;
 * <tt> InmetHourlyDataDAO dao = InmetHourlyDataDAO.getInstanceOf(logClientName, logLevel);</tt>
 * </p>
 * <br>
 * 
 * @author Sergio Lopes Jr.
 * @version 0.1
 * @since 03/03/2020 (creation date)
 *
 */
public class InmetStationDAO extends GenericDAO<InmetStationDAO, InmetStationEntity> {

	private static InmetStationDAO instance;

	/**
	 * Private class constructor.
	 * 
	 * @param logClientName Name of the client object of the logging service.
	 * @param logLevel      Log level to be used in log service.
	 * @throws PersistenceException Occurrence of any problems in creating of the
	 *                              DAO.
	 */
	private InmetStationDAO(String logClientName, Level logLevel) throws PersistenceException {
		super(logClientName, logLevel);

		// initializing database
		this.init();

		// DAO create success
		this.success(MessageEnum.GENERIC_DAO_INFO_SUCCESS_CREATE, NetworkUtil.getLocalIpAddress(),
				this.getDAODescriptor());
	}

	/**
	 * Method to retrieve the instance of DAO. This class has a single instance for
	 * any application (Singleton).
	 * 
	 * @return Returns the instance of DAO.
	 * @throws PersistenceException Occurrence of any problems in creating of the
	 *                              DAO.
	 */
	public static synchronized InmetStationDAO getInstanceOf(String logClientName, Level logLevel)
			throws PersistenceException {
		if (InmetStationDAO.instance == null) {
			InmetStationDAO.instance = new InmetStationDAO(logClientName, logLevel);
		}
		return InmetStationDAO.instance;
	}

	/**
	 * Method to retrieve the instance of DAO. This class has a single instance for
	 * any application (Singleton).<br>
	 * To use this method, it is necessary that the DAO instance has already been
	 * created by executing the getInstanceOf(String logClientName, Level logLevel)
	 * method.
	 * 
	 * @return Returns the instance of DAO.
	 * @throws PersistenceException Occurrence of any problems in retrieving of the
	 *                              DAO instance.
	 */
	public static synchronized InmetStationDAO getInstanceOf() throws PersistenceException {
		return InmetStationDAO.getInstanceOf(InmetStationDAO.class.getSimpleName(), LOG_DEFAULT_LEVEL);
	}

	@Override
	public InmetStationDAO save(InmetStationEntity entity) throws PersistenceException {

		// validate entity
		Long id = entity != null ? entity.getId() : null;

		// saving moduleAddress relationship with module address entity
		this.saveStationRelationship(entity.getCityEntily());

		// save ou update the entity
		id = super.save(//
				entity.getId() //
				, "INSERT INTO public." + TABLE_INMET_STATION + "(" + //
						"id_city," + //
						"code," + "start_date)" + //
						"VALUES (" + //
						entity.getCityEntily().getId() + "," + //
						"'" + entity.getCode() + "'" + "," + //
						"'" + entity.getStartDate() + "'" + ");"//
				, //
				"UPDATE public." + TABLE_INMET_STATION + " SET " + //
						"id_city=" + entity.getCityEntily().getId() + "," + //
						"code=" + "'" + entity.getCode() + "'" + "," + //
						"start_date=" + "'" + entity.getStartDate() + "'" + //
						"WHERE id=" + entity.getId()); //

		// return DAO instance
		return this;
	}

	@Override
	public InmetStationDAO remove(Long id) throws PersistenceException {

		// verifying that the id is valid
		if (id == null || id == 0) {
			throw this.error(NetworkUtil.getLocalIpAddress(), MessageEnum.GENERIC_DAO_ERROR_REMOVE,
					this.getClass().getSimpleName(), "remove", null, null, true, NetworkUtil.getLocalIpAddress(),
					this.getDAODescriptor(), String.valueOf(id));
		}

		try {
			// retrienving id for station relationship
//			InmetStationEntity station = this.find(id).getStation();

			// removing entity
			super.remove(id, "DELETE FROM " + TABLE_INMET_STATION + " WHERE id=" + id + ";");

			// removing remotesModulesAddresses relationship with module address entity
//			this.removeStationRelationship(station.getId());

		} catch (PersistenceException e) {
			throw (e);
		}

		// return DAO instance
		return this;
	}

	@Override
	public InmetStationEntity find(Long id) throws PersistenceException {
		return super.find(id, "SELECT * FROM " + TABLE_INMET_STATION + " WHERE id=" + id + ";");
	}

	@Override
	public List<InmetStationEntity> list() throws PersistenceException {
		return super.list("SELECT * FROM " + TABLE_INMET_STATION + ";");
	}

	@Override
	public InmetStationDAO init() throws PersistenceException {

		// initializing variables
		List<String> queries = new ArrayList<String>();

		// SQL for entity table create
		queries.add(//
				"CREATE TABLE IF NOT EXISTS public." + TABLE_INMET_STATION + //
						"(" + //
						"id bigserial NOT NULL," + //
						"id_city bigserial NOT NULL REFERENCES " + TABLE_INMET_CITY + "(id)," + //
						"code text NOT NULL," + //
						"start_date date NOT NULL," + //
						"PRIMARY KEY (id)" + //
						");"//
		);

		super.init(queries);

		List<InmetStationEntity> entities = this.list();

		if (entities.size() == 0) {
			queries.clear();
			queries.add("INSERT INTO station(id_city,code,start_date) " //
					+ "VALUES " //
					+ "(298,'A422','21/07/2008')," //
					+ "(160,'A360','22/04/2009')," //
					+ "(345,'A657','25/09/2011')," //
					+ "(26,'A908','16/12/2006')," //
					+ "(424,'A756','15/08/2010')," //
					+ "(176,'A045','02/10/2008')," //
					+ "(358,'A549','09/09/2007')," //
					+ "(359,'A534','05/08/2007')," //
					+ "(346,'A617','25/10/2006')," //
					+ "(515,'A826','29/09/2006')," //
					+ "(347,'A615','02/11/2006')," //
					+ "(69,'A053','01/04/2016')," //
					+ "(360,'A508','09/12/2002')," //
					+ "(27,'A924','23/05/2007')," //
					+ "(89,'A253','25/10/2018')," //
					+ "(28,'A909','22/09/2011')," //
					+ "(1,'A024','02/05/2007')," //
					+ "(121,'A223','03/06/2008')," //
					+ "(29,'A934','29/01/2008')," //
					+ "(138,'A336','17/11/2007')," //
					+ "(425,'A750','12/06/2008')," //
					+ "(299,'A434','11/07/2008')," //
					+ "(426,'S701','09/04/2018')," //
					+ "(139,'A377','14/11/2019')," //
					+ "(490,'A628','25/08/2017')," //
					+ "(30,'A910','24/10/2006')," //
					+ "(230,'A340','14/11/2007')," //
					+ "(275,'A113','19/07/2008')," //
					+ "(427,'A719','01/11/2006')," //
					+ "(181,'A409','12/02/2003')," //
					+ "(361,'A566','21/05/2017')," //
					+ "(2,'A013','13/07/2007')," //
					+ "(70,'A054','19/08/2015')," //
					+ "(71,'A021','26/01/2007')," //
					+ "(72,'A044','12/03/2009')," //
					+ "(428,'S702','13/04/2018')," //
					+ "(559,'A867','28/09/2008')," //
					+ "(268,'A353','27/04/2008')," //
					+ "(362,'A505','19/12/2002')," //
					+ "(247,'A309','20/11/2004')," //
					+ "(238,'A310','16/11/2004')," //
					+ "(65,'A940','18/07/2008')," //
					+ "(188,'A736','15/11/2007')," //
					+ "(491,'A606','22/09/2006')," //
					+ "(276,'A120','17/04/2008')," //
					+ "(189,'A725','22/09/2006')," //
					+ "(122,'A220','09/07/2008')," //
					+ "(516,'A827','04/01/2007')," //
					+ "(140,'A375','23/03/2018')," //
					+ "(123,'A204','26/10/2007')," //
					+ "(363,'A565','22/11/2016')," //
					+ "(364,'A502','05/12/2002')," //
					+ "(161,'A315','31/05/2007')," //
					+ "(277,'A128','19/04/2008')," //
					+ "(300,'A429','12/05/2008')," //
					+ "(190,'A741','28/04/2008')," //
					+ "(124,'A221','06/03/2008')," //
					+ "(191,'A746','04/07/2008')," //
					+ "(301,'A402','20/12/2001')," //
					+ "(192,'A748','19/06/2010')," //
					+ "(193,'A755','23/03/2011')," //
					+ "(429,'A759','21/03/2013')," //
					+ "(194,'A705','30/08/2001')," //
					+ "(195,'A764','27/11/2016')," //
					+ "(430,'A757','09/08/2011')," //
					+ "(90,'A201','20/01/2003')," //
					+ "(302,'A447','02/07/2009')," //
					+ "(365,'F501','01/10/2014')," //
					+ "(366,'A521','10/10/2006')," //
					+ "(517,'A840','01/12/2006')," //
					+ "(196,'A765','01/02/2017')," //
					+ "(278,'A110','15/07/2008')," //
					+ "(303,'A418','18/05/2007')," //
					+ "(141,'A326','17/07/2007')," //
					+ "(91,'A226','11/03/2008')," //
					+ "(197,'A744','20/12/2017')," //
					+ "(431,'S705','06/04/2018')," //
					+ "(177,'A001','07/05/2000')," //
					+ "(178,'A042','19/07/2017')," //
					+ "(182,'A421','17/07/2008')," //
					+ "(92,'A228','21/10/2017')," //
					+ "(304,'A433','28/04/2008')," //
					+ "(125,'A238','11/09/2008')," //
					+ "(305,'A432','15/05/2008')," //
					+ "(367,'A544','19/06/2007')," //
					+ "(432,'S706','06/03/2018')," //
					+ "(239,'A348','28/02/2008')," //
					+ "(248,'A329','04/09/2007')," //
					+ "(560,'A859','19/03/2008')," //
					+ "(518,'A812','22/06/2006')," //
					+ "(31,'A941','30/03/2012')," //
					+ "(198,'A769','20/10/2017')," //
					+ "(66,'A939','20/07/2008')," //
					+ "(3,'A023','21/05/2007')," //
					+ "(231,'A316','07/01/2007')," //
					+ "(232,'A344','08/05/2008')," //
					+ "(368,'A530','28/11/2006')," //
					+ "(519,'A838','12/12/2006')," //
					+ "(240,'A352','04/05/2008')," //
					+ "(520,'A897','24/11/2016')," //
					+ "(492,'A604','20/11/2002')," //
					+ "(93,'A236','20/06/2008')," //
					+ "(464,'B803','04/08/2016')," //
					+ "(241,'A313','22/12/2006')," //
					+ "(369,'A519','14/07/2003')," //
					+ "(521,'A884','29/11/2013')," //
					+ "(433,'A702','11/09/2001')," //
					+ "(142,'A376','23/11/2018')," //
					+ "(32,'A905','12/12/2012')," //
					+ "(33,'A912','21/11/2006')," //
					+ "(494,'A620','13/06/2008')," //
					+ "(199,'A706','14/03/2002')," //
					+ "(493,'A607','22/09/2006')," //
					+ "(73,'A043','29/10/2012')," //
					+ "(561,'A898','15/02/2019')," //
					+ "(162,'A347','07/03/2008')," //
					+ "(522,'A879','23/08/2008')," //
					+ "(523,'A811','24/01/2007')," //
					+ "(143,'A365','12/06/2010')," //
					+ "(524,'A887','18/07/2019')," //
					+ "(370,'A541','02/09/2007')," //
					+ "(94,'A248','18/04/2011')," //
					+ "(144,'A337','10/11/2007')," //
					+ "(371,'A554','23/05/2007')," //
					+ "(306,'A405','20/12/2002')," //
					+ "(183,'A420','28/03/2008')," //
					+ "(34,'A926','10/04/2008')," //
					+ "(495,'A629','11/10/2018')," //
					+ "(126,'A205','04/12/2007')," //
					+ "(249,'A341','21/11/2007')," //
					+ "(200,'A738','28/06/2007')," //
					+ "(434,'A742','08/03/2008')," //
					+ "(95,'A202','24/01/2003')," //
					+ "(145,'A361','20/04/2009')," //
					+ "(465,'A819','09/07/2006')," //
					+ "(4,'A034','31/01/2008')," //
					+ "(127,'A237','13/07/2008')," //
					+ "(372,'A548','22/06/2007')," //
					+ "(435,'A730','19/12/2006')," //
					+ "(128,'A206','17/09/2008')," //
					+ "(562,'A895','18/02/2019')," //
					+ "(466,'A869','10/03/2008')," //
					+ "(467,'A876','16/05/2008')," //
					+ "(279,'A117','12/04/2008')," //
					+ "(129,'A222','03/06/2008')," //
					+ "(74,'A049','12/11/2016')," //
					+ "(468,'B806','28/05/2016')," //
					+ "(35,'A913','28/11/2006')," //
					+ "(373,'A520','16/07/2006')," //
					+ "(96,'A241','04/09/2008')," //
					+ "(307,'A431','07/04/2008')," //
					+ "(374,'A557','17/10/2012')," //
					+ "(146,'A374','28/03/2018')," //
					+ "(308,'A416','09/11/2007')," //
					+ "(436,'A724','27/10/2006')," //
					+ "(269,'A355','06/09/2008')," //
					+ "(437,'A760','04/12/2012')," //
					+ "(36,'A919','27/05/2007')," //
					+ "(438,'A720','07/11/2006')," //
					+ "(163,'A342','11/12/2008')," //
					+ "(5,'A036','13/12/2007')," //
					+ "(5,'A056','25/01/2018')," //
					+ "(525,'A853','31/05/2007')," //
					+ "(309,'A406','19/01/2003')," //
					+ "(261,'A108','14/05/2015')," //
					+ "(37,'A901','07/12/2002')," //
					+ "(310,'A448','20/08/2015')," //
					+ "(469,'A807','28/01/2003')," //
					+ "(563,'A860','03/03/2008')," //
					+ "(375,'A538','19/12/2006')," //
					+ "(311,'A443','15/07/2008')," //
					+ "(470,'A849','08/03/2008')," //
					+ "(376,'A537','05/06/2006')," //
					+ "(75,'A038','30/08/2008')," //
					+ "(564,'A848','31/05/2008')," //
					+ "(377,'A564','26/10/2017')," //
					+ "(471,'A843','29/03/2007')," //
					+ "(97,'A252','08/03/2018')," //
					+ "(526,'A881','23/04/2010')," //
					+ "(378,'A536','01/06/2007')," //
					+ "(439,'A721','21/10/2006')," //
					+ "(201,'A762','03/11/2016')," //
					+ "(496,'A603','21/10/2002')," //
					+ "(348,'A631','17/03/2017')," //
					+ "(7,'A029','26/08/2017')," //
					+ "(280,'A109','31/08/2012')," //
					+ "(527,'A893','15/03/2018')," //
					+ "(262,'A140','25/09/2009')," //
					+ "(528,'A828','25/11/2006')," //
					+ "(130,'A224','27/02/2008')," //
					+ "(312,'A442','31/03/2008')," //
					+ "(131,'A218','22/11/2008')," //
					+ "(132,'A217','28/11/2008')," //
					+ "(263,'A138','24/09/2009')," //
					+ "(313,'A413','26/05/2007')," //
					+ "(250,'A351','15/09/2008')," //
					+ "(379,'A535','27/06/2008')," //
					+ "(147,'A311','18/11/2004')," //
					+ "(565,'A806','22/01/2003')," //
					+ "(380,'A524','17/08/2006')," //
					+ "(314,'A452','02/06/2016')," //
					+ "(76,'A039','27/04/2008')," //
					+ "(164,'A305','18/02/2003')," //
					+ "(472,'A846','15/02/2008')," //
					+ "(202,'A708','10/12/2002')," //
					+ "(529,'A854','13/12/2007')," //
					+ "(179,'A046','01/10/2014')," //
					+ "(251,'A322','08/07/2007')," //
					+ "(38,'A930','06/06/2008')," //
					+ "(473,'A875','10/04/2008')," //
					+ "(148,'A364','16/05/2009')," //
					+ "(8,'A022','02/06/2007')," //
					+ "(9,'A002','30/05/2001')," //
					+ "(10,'A014','16/07/2007')," //
					+ "(474,'A825','19/10/2006')," //
					+ "(381,'A532','29/05/2007')," //
					+ "(133,'A207','10/09/2008')," //
					+ "(315,'A426','24/04/2008')," //
					+ "(382,'A533','02/06/2007')," //
					+ "(165,'A314','26/05/2007')," //
					+ "(39,'A906','20/12/2002')," //
					+ "(383,'A546','11/07/2007')," //
					+ "(40,'A932','25/01/2008')," //
					+ "(77,'A019','20/12/2006')," //
					+ "(281,'A112','25/04/2008')," //
					+ "(252,'A349','14/10/2008')," //
					+ "(384,'A555','07/06/2008')," //
					+ "(530,'A883','13/12/2012')," //
					+ "(203,'A737','09/11/2007')," //
					+ "(316,'A439','28/04/2008')," //
					+ "(475,'A824','15/11/2006')," //
					+ "(204,'A712','19/07/2006')," //
					+ "(440,'S709','14/04/2018')," //
					+ "(166,'A319','30/05/2007')," //
					+ "(317,'A410','25/01/2003')," //
					+ "(134,'A225','01/03/2008')," //
					+ "(476,'A823','16/10/2006')," //
					+ "(566,'A817','02/07/2006')," //
					+ "(443,'A709','10/02/2003')," //
					+ "(233,'A372','08/11/2017')," //
					+ "(318,'A445','30/06/2009')," //
					+ "(11,'A028','24/06/2013')," //
					+ "(319,'A424','31/03/2008')," //
					+ "(184,'A451','24/04/2017')," //
					+ "(185,'A417','23/05/2007')," //
					+ "(320,'A408','29/01/2003')," //
					+ "(282,'A121','17/04/2008')," //
					+ "(98,'A231','17/02/2008')," //
					+ "(567,'A868','24/06/2010')," //
					+ "(321,'A455','28/05/2016')," //
					+ "(385,'A550','05/09/2007')," //
					+ "(12,'A015','03/02/2007')," //
					+ "(322,'A446','25/06/2009')," //
					+ "(205,'A714','25/07/2006')," //
					+ "(167,'A359','05/09/2008')," //
					+ "(206,'A739','13/11/2007')," //
					+ "(568,'A851','06/06/2007')," //
					+ "(441,'S710','26/02/2018')," //
					+ "(242,'A373','03/11/2017')," //
					+ "(442,'A752','31/05/2008')," //
					+ "(497,'A635','01/09/2017')," //
					+ "(294,'A251','24/08/2017')," //
					+ "(41,'A933','14/08/2008')," //
					+ "(323,'A407','09/02/2003')," //
					+ "(386,'A512','11/05/2006')," //
					+ "(13,'A035','02/11/2007')," //
					+ "(569,'A863','05/03/2008')," //
					+ "(207,'A753','17/08/2008')," //
					+ "(477,'A818','12/07/2006')," //
					+ "(324,'A440','01/05/2008')," //
					+ "(531,'A836','09/01/2007')," //
					+ "(168,'A358','10/09/2008')," //
					+ "(169,'A339','10/11/2007')," //
					+ "(208,'A733','23/08/2007')," //
					+ "(387,'A563','19/11/2016')," //
					+ "(388,'A559','04/06/2016')," //
					+ "(478,'A871','28/02/2008')," //
					+ "(444,'A758','04/08/2011')," //
					+ "(14,'A016','24/05/2007')," //
					+ "(325,'A450','13/08/2015')," //
					+ "(570,'A841','19/09/2007')," //
					+ "(243,'A320','21/07/2007')," //
					+ "(389,'A553','07/07/2007')," //
					+ "(479,'A821','23/11/2006')," //
					+ "(209,'A735','04/09/2007')," //
					+ "(42,'A914','02/11/2006')," //
					+ "(43,'A920','01/12/2006')," //
					+ "(390,'A518','26/05/2007')," //
					+ "(445,'A749','18/06/2008')," //
					+ "(283,'A111','27/07/2008')," //
					+ "(78,'A055','15/11/2016')," //
					+ "(532,'A844','02/03/2007')," //
					+ "(572,'A866','31/05/2008')," //
					+ "(446,'S711','07/03/2018')," //
					+ "(571,'A865','06/11/2014')," //
					+ "(480,'B804','07/08/2016')," //
					+ "(326,'A425','05/04/2008')," //
					+ "(349,'A614','27/10/2006')," //
					+ "(210,'A727','20/09/2006')," //
					+ "(327,'A404','18/04/2002')," //
					+ "(15,'A012','21/10/2006')," //
					+ "(498,'A608','22/09/2006')," //
					+ "(328,'A412','03/02/2003')," //
					+ "(295,'A249','12/12/2013')," //
					+ "(234,'A317','06/01/2007')," //
					+ "(270,'A303','25/02/2003')," //
					+ "(391,'A567','21/07/2017')," //
					+ "(573,'A864','09/02/2009')," //
					+ "(284,'A119','10/04/2004')," //
					+ "(285,'A101','09/05/2000')," //
					+ "(392,'A556','25/09/2010')," //
					+ "(286,'A133','12/12/2011')," //
					+ "(393,'A540','01/08/2007')," //
					+ "(99,'A240','25/06/2009')," //
					+ "(447,'A731','14/12/2006')," //
					+ "(329,'A438','22/06/2008')," //
					+ "(481,'A820','18/11/2006')," //
					+ "(264,'A137','27/10/2009')," //
					+ "(394,'A531','01/12/2006')," //
					+ "(79,'A041','24/11/2012')," //
					+ "(350,'A632','20/03/2017')," //
					+ "(211,'A763','13/05/2017')," //
					+ "(482,'A835','21/11/2006')," //
					+ "(80,'A040','25/10/2012')," //
					+ "(287,'A122','22/04/2008')," //
					+ "(100,'A209','17/02/2008')," //
					+ "(101,'A246','28/09/2010')," //
					+ "(16,'A026','23/10/2007')," //
					+ "(448,'A722','02/11/2006')," //
					+ "(395,'A539','11/11/2007')," //
					+ "(396,'A526','26/06/2007')," //
					+ "(102,'A239','06/07/2012')," //
					+ "(17,'A032','06/06/2007')," //
					+ "(398,'A509','19/12/2004')," //
					+ "(244,'A334','22/08/2007')," //
					+ "(397,'A506','16/12/2002')," //
					+ "(170,'A332','24/08/2007')," //
					+ "(483,'A873','13/03/2008')," //
					+ "(18,'A003','30/05/2001')," //
					+ "(574,'A845','18/06/2007')," //
					+ "(235,'A318','22/05/2007')," //
					+ "(533,'A878','12/03/2008')," //
					+ "(399,'A517','28/08/2006')," //
					+ "(236,'A304','24/02/2003')," //
					+ "(449,'A717','03/08/2006')," //
					+ "(499,'A627','13/07/2018')," //
					+ "(186,'A453','24/03/2017')," //
					+ "(450,'S712','22/02/2018')," //
					+ "(484,'A842','08/02/2007')," //
					+ "(500,'A624','18/09/2010')," //
					+ "(44,'A928','17/04/2008')," //
					+ "(485,'A822','20/12/2006')," //
					+ "(45,'A929','13/04/2008')," //
					+ "(351,'A623','23/06/2008')," //
					+ "(288,'A144','18/07/2019')," //
					+ "(575,'A816','20/09/2008')," //
					+ "(46,'A927','29/02/2008')," //
					+ "(103,'A235','23/07/2008')," //
					+ "(104,'A232','05/07/2012')," //
					+ "(149,'A354','22/07/2008')," //
					+ "(296,'A242','11/09/2008')," //
					+ "(400,'A570','20/10/2017')," //
					+ "(253,'A366','11/08/2010')," //
					+ "(212,'A716','30/08/2006')," //
					+ "(401,'A513','28/07/2006')," //
					+ "(105,'A210','27/02/2008')," //
					+ "(254,'A357','04/09/2008')," //
					+ "(81,'A009','17/12/2004')," //
					+ "(534,'A856','27/02/2008')," //
					+ "(271,'A327','11/07/2007')," //
					+ "(272,'A323','14/07/2007')," //
					+ "(402,'A571','15/03/2008')," //
					+ "(106,'A212','18/10/2007')," //
					+ "(82,'A010','04/03/2005')," //
					+ "(451,'A710','13/11/2007')," //
					+ "(486,'A850','05/03/2008')," //
					+ "(47,'A915','19/12/2006')," //
					+ "(180,'A047','07/02/2017')," //
					+ "(501,'A619','06/12/2006')," //
					+ "(19,'A027','30/03/2008')," //
					+ "(289,'A123','10/04/2008')," //
					+ "(150,'A308','06/02/2003')," //
					+ "(265,'A102','05/08/2008')," //
					+ "(403,'A529','30/05/2007')," //
					+ "(535,'A839','27/11/2006')," //
					+ "(404,'A516','16/07/2006')," //
					+ "(245,'A321','21/07/2007')," //
					+ "(405,'A562','12/05/2017')," //
					+ "(406,'A523','22/08/2006')," //
					+ "(151,'A330','31/08/2007')," //
					+ "(83,'A020','23/01/2007')," //
					+ "(452,'S714','02/02/2018')," //
					+ "(84,'A018','01/12/2006')," //
					+ "(255,'A307','21/02/2003')," //
					+ "(502,'A610','22/10/2006')," //
					+ "(330,'A430','03/05/2008')," //
					+ "(152,'A343','12/12/2008')," //
					+ "(331,'A449','01/04/2016')," //
					+ "(213,'A726','26/09/2006')," //
					+ "(273,'A371','20/09/2017')," //
					+ "(407,'A545','04/07/2007')," //
					+ "(20,'A033','12/10/2007')," //
					+ "(153,'A335','31/08/2007')," //
					+ "(85,'A051','06/04/2016')," //
					+ "(107,'A211','14/02/2008')," //
					+ "(487,'A855','07/11/2007')," //
					+ "(187,'A419','03/04/2008')," //
					+ "(453,'A703','06/09/2001')," //
					+ "(48,'A937','31/01/2008')," //
					+ "(21,'A005','04/06/2001')," //
					+ "(536,'A801','18/09/2000')," //
					+ "(108,'A245','19/06/2019')," //
					+ "(49,'A935','27/02/2008')," //
					+ "(297,'A244','17/09/2008')," //
					+ "(454,'A723','24/10/2006')," //
					+ "(332,'A427','10/07/2008')," //
					+ "(67,'A925','11/07/2007')," //
					+ "(266,'A136','29/10/2009')," //
					+ "(22,'A017','18/04/2007')," //
					+ "(214,'A747','20/04/2008')," //
					+ "(290,'A126','19/04/2008')," //
					+ "(352,'A622','18/06/2008')," //
					+ "(215,'A707','03/02/2003')," //
					+ "(50,'A923','26/10/2007')," //
					+ "(537,'A831','17/10/2007')," //
					+ "(333,'A436','23/05/2008')," //
					+ "(51,'A916','20/07/2007')," //
					+ "(171,'A369','20/03/2018')," //
					+ "(172,'A325','09/07/2007')," //
					+ "(216,'A718','02/09/2006')," //
					+ "(576,'A870','01/06/2016')," //
					+ "(256,'A301','22/12/2004')," //
					+ "(109,'A254','11/07/2019')," //
					+ "(217,'A766','09/02/2017')," //
					+ "(334,'A423','26/03/2008')," //
					+ "(503,'A609','29/09/2006')," //
					+ "(455,'S715','18/01/2018')," //
					+ "(335,'A458','20/09/2018')," //
					+ "(267,'A104','11/07/2008')," //
					+ "(456,'A743','26/06/2008')," //
					+ "(504,'A626','03/06/2016')," //
					+ "(505,'A652','18/05/2007')," //
					+ "(506,'A636','10/08/2017')," //
					+ "(507,'A602','07/10/2002')," //
					+ "(508,'A621','13/04/2007')," //
					+ "(577,'A861','06/03/2008')," //
					+ "(538,'A802','06/09/2001')," //
					+ "(578,'A862','22/03/2008')," //
					+ "(539,'A813','01/10/2006')," //
					+ "(408,'A551','17/11/2007')," //
					+ "(86,'A050','03/08/2016')," //
					+ "(291,'A125','26/06/2008')," //
					+ "(23,'A025','17/05/2007')," //
					+ "(110,'A214','17/04/2008')," //
					+ "(52,'A907','17/11/2003')," //
					+ "(53,'A944','30/05/2019')," //
					+ "(409,'A525','18/08/2006')," //
					+ "(257,'A370','15/09/2017')," //
					+ "(410,'A552','14/07/2007')," //
					+ "(111,'A215','14/06/2008')," //
					+ "(54,'A936','28/01/2008')," //
					+ "(336,'A401','13/05/2000')," //
					+ "(337,'A456','09/03/2018')," //
					+ "(237,'A367','17/08/2010')," //
					+ "(87,'A048','30/07/2016')," //
					+ "(540,'A803','03/09/2001')," //
					+ "(509,'A630','16/11/2012')," //
					+ "(338,'A415','28/05/2007')," //
					+ "(457,'S716','19/04/2018')," //
					+ "(542,'A810','15/11/2006')," //
					+ "(88,'A052','14/08/2015')," //
					+ "(353,'A613','09/08/2007')," //
					+ "(543,'A899','15/03/2008')," //
					+ "(112,'A233','30/05/2008')," //
					+ "(541,'A804','21/11/2001')," //
					+ "(113,'A250','02/09/2015')," //
					+ "(544,'A833','05/02/2009')," //
					+ "(55,'A931','31/05/2008')," //
					+ "(545,'A805','05/12/2001')," //
					+ "(546,'A830','21/07/2007')," //
					+ "(218,'A711','05/09/2006')," //
					+ "(56,'A921','18/10/2007')," //
					+ "(114,'A216','16/11/2016')," //
					+ "(547,'A832','12/10/2007')," //
					+ "(292,'A134','31/08/2011')," //
					+ "(458,'A732','16/12/2006')," //
					+ "(246,'A333','06/11/2007')," //
					+ "(411,'A514','09/06/2006')," //
					+ "(154,'A331','26/08/2007')," //
					+ "(579,'A815','12/04/2008')," //
					+ "(57,'A903','25/02/2003')," //
					+ "(58,'A942','19/02/2019')," //
					+ "(548,'A829','26/10/2006')," //
					+ "(135,'A203','29/01/2003')," //
					+ "(219,'A740','01/11/2007')," //
					+ "(274,'A356','08/09/2008')," //
					+ "(549,'A852','25/07/2007')," //
					+ "(354,'A616','26/10/2006')," //
					+ "(488,'A874','18/04/2011')," //
					+ "(220,'A715','16/08/2006')," //
					+ "(24,'A031','30/06/2017')," //
					+ "(580,'A857','12/03/2008')," //
					+ "(222,'A771','14/03/2018')," //
					+ "(221,'A701','25/07/2006')," //
					+ "(155,'A362','20/05/2009')," //
					+ "(258,'A302','02/11/2003')," //
					+ "(156,'A345','27/02/2008')," //
					+ "(412,'A547','30/06/2007')," //
					+ "(223,'A767','26/10/2017')," //
					+ "(413,'A561','17/08/2015')," //
					+ "(25,'A011','14/07/2006')," //
					+ "(25,'A770','03/07/2019')," //
					+ "(550,'A889','06/04/2016')," //
					+ "(59,'A911','20/10/2017')," //
					+ "(510,'A667','02/08/2015')," //
					+ "(459,'S717','06/04/2018')," //
					+ "(339,'A428','27/03/2008')," //
					+ "(551,'A894','06/04/2016')," //
					+ "(511,'A601','07/05/2000')," //
					+ "(414,'A522','21/08/2006')," //
					+ "(115,'A230','03/09/2008')," //
					+ "(60,'A943','29/03/2019')," //
					+ "(259,'A350','09/07/2008')," //
					+ "(340,'A441','09/05/2008')," //
					+ "(415,'A569','10/04/2016')," //
					+ "(460,'A751','06/06/2008')," //
					+ "(461,'A754','30/09/2008')," //
					+ "(512,'A659','28/08/2015')," //
					+ "(61,'A917','29/10/2006')," //
					+ "(173,'A306','12/02/2003')," //
					+ "(552,'A837','27/02/2008')," //
					+ "(462,'A761','30/11/2012')," //
					+ "(225,'A713','21/08/2006')," //
					+ "(62,'A904','16/12/2002')," //
					+ "(116,'A227','27/04/2008')," //
					+ "(260,'A328','09/03/2008')," //
					+ "(63,'A902','12/10/2002')," //
					+ "(174,'A324','12/07/2007')," //
					+ "(226,'A728','20/12/2006')," //
					+ "(416,'A527','25/08/2006')," //
					+ "(157,'A312','24/11/2004')," //
					+ "(513,'A618','01/11/2006')," //
					+ "(553,'A882','04/10/2012')," //
					+ "(175,'A368','14/03/2018')," //
					+ "(417,'A511','22/02/2006')," //
					+ "(117,'A213','14/10/2007')," //
					+ "(554,'A808','01/06/2006')," //
					+ "(555,'A834','09/03/2008')," //
					+ "(463,'A704','03/09/2001')," //
					+ "(418,'A528','28/08/2006')," //
					+ "(514,'A625','07/06/2016')," //
					+ "(118,'A234','18/07/2008')," //
					+ "(119,'A229','01/03/2008')," //
					+ "(227,'A768','12/05/2017')," //
					+ "(556,'A886','11/08/2016')," //
					+ "(136,'A219','10/06/2008')," //
					+ "(341,'A435','20/05/2008')," //
					+ "(419,'A568','18/05/2017')," //
					+ "(420,'A507','14/12/2002')," //
					+ "(342,'A437','25/06/2008')," //
					+ "(421,'A542','15/06/2007')," //
					+ "(293,'A124','17/04/2008')," //
					+ "(158,'A346','06/03/2008')," //
					+ "(557,'A809','25/09/2006')," //
					+ "(581,'A814','28/05/2008')," //
					+ "(558,'A880','26/04/2008')," //
					+ "(343,'A444','29/06/2009')," //
					+ "(159,'A363','18/04/2009')," //
					+ "(228,'A734','28/08/2007')," //
					+ "(422,'A515','13/07/2006')," //
					+ "(355,'A633','11/02/2017')," //
					+ "(489,'A872','15/04/2011')," //
					+ "(423,'A510','15/09/2005')," //
					+ "(64,'A922','24/11/2006')," //
					+ "(356,'A634','15/02/2017')," //
					+ "(68,'A938','26/08/2008')," //
					+ "(357,'A612','31/10/2006')," //
					+ "(344,'A414','01/06/2007')," //
					+ "(229,'A729','07/12/2006')," //
					+ "(582,'A858','15/03/2008')," //
					+ "(120,'A247','11/09/2016')," //
					+ "(137,'A255','18/09/2019')" //
			);

			super.init(queries);
		}
		return this;
	}

	@Override
	protected InmetStationEntity getEntity(ResultSet queryResult) throws PersistenceException {

		Long id = null;
		try {
			// retrieving the attributes
			id = queryResult.getObject("id") != null ? queryResult.getLong("id") : null;

			// Recovering relationship
			Long idCity = queryResult.getLong("id_city");
			InmetCityEntily cityEntily = this.getCityRelationship(idCity);

			// creating new entity with attributes retrieved from database
			return new InmetStationEntity( //
					queryResult.getLong("id"), //
					queryResult.getString("code"), //
					cityEntily, //
					TimeUtil.stringToLocalDate(queryResult.getString("start_date"))//
			); //

		} catch (Throwable e) {
			throw this.error(NetworkUtil.getLocalIpAddress(), MessageEnum.GENERIC_DAO_ERROR_GET_ENTITY,
					this.getClass().getSimpleName(), "getEntity", e.getMessage(), null, true,
					NetworkUtil.getLocalIpAddress(), this.getDAODescriptor(), String.valueOf(id));
		}
	}

	/**
	 * Saves the module address entity associated with the moduleAddress
	 * relationship (1-1).
	 * 
	 * @param entity Relationship entity to be saved.
	 * @return Returns the instance of DAO.
	 * @throws PersistenceException Occurrence of any problems in saving of the
	 *                              relationship.
	 */
	private InmetStationDAO saveStationRelationship(InmetCityEntily entity) throws PersistenceException {
		if (entity != null) {
			InmetCityDataDAO.getInstanceOf().save(entity);
		}
		return this;
	}

	/**
	 * Removes the module address entity associated with the moduleAddress
	 * relationship (1-1) according to the informed identification (ID).
	 * 
	 * @param entityId Identifier (ID) of the entity associated with the
	 *                 moduleAddress relationship.
	 * @return Returns the instance of DAO.
	 */
	private InmetStationDAO removeCityRelationship(Long entityId) {
		try {
			InmetCityDataDAO.getInstanceOf().remove(entityId);
		} catch (Throwable e) {
		}
		return this;
	}

	/**
	 * Retrieves the module address entity associated with the moduleAddress
	 * relationship (1-1) according to the informed identification (ID).
	 * 
	 * @param entityId Identification of the entity (ID) of the relationship.
	 * @return Returns the instance of relationship entity.
	 * @throws PersistenceException Occurrence of any problems in retrieving of the
	 *                              relationship.
	 */
	private InmetCityEntily getCityRelationship(Long entityId) throws PersistenceException {
		if (entityId != null) {
			return InmetCityDataDAO.getInstanceOf().find(entityId);
		}
		return null;
	}

}
