package br.embrapa.cnpaf.inmetdata.dao;

import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.List;

import org.apache.log4j.Level;

import br.embrapa.cnpaf.inmetdata.entity.CityEntily;
import br.embrapa.cnpaf.inmetdata.entity.InmetStationEntity;
import br.embrapa.cnpaf.inmetdata.enumerate.MessageEnum;
import br.embrapa.cnpaf.inmetdata.exception.PersistenceException;
import br.embrapa.cnpaf.inmetdata.util.NetworkUtil;
import br.embrapa.cnpaf.inmetdata.util.TimeUtil;

/**
 * <br>
 * <p>
 * <b> Singleton Class responsible for by performing the persistence of entities
 * of the type InmetHourlyDataEntity.</b>
 * </p>
 * <p>
 * It uses the standard Data Access Object design - DAO, in order to separate
 * the other system classes the code needed to interface with the database. For
 * this it defines the methods save, delete, find and list to persist or
 * retrieve the entities.
 * </p>
 * <p>
 * To retrieve an instance of this class use the static method getInstanceOf
 * ():<br>
 * <br>
 * &nbsp;&nbsp;&nbsp;&nbsp;
 * <tt> InmetHourlyDataDAO dao = InmetHourlyDataDAO.getInstanceOf(logClientName, logLevel);</tt>
 * </p>
 * <br>
 * 
 * @author Sergio Lopes Jr.
 * @version 0.1
 * @since 03/03/2020 (creation date)
 *
 */
public class InmetStationDAO extends GenericDAO<InmetStationDAO, InmetStationEntity> {

	private static InmetStationDAO instance;

	/**
	 * Private class constructor.
	 * 
	 * @param logClientName Name of the client object of the logging service.
	 * @param logLevel      Log level to be used in log service.
	 * @throws PersistenceException Occurrence of any problems in creating of the
	 *                              DAO.
	 */
	private InmetStationDAO(String logClientName, Level logLevel) throws PersistenceException {
		super(logClientName, logLevel);

		// initializing database
		this.init();

		// DAO create success
		this.success(MessageEnum.GENERIC_DAO_INFO_SUCCESS_CREATE, NetworkUtil.getLocalIpAddress(),
				this.getDAODescriptor());
	}

	/**
	 * Method to retrieve the instance of DAO. This class has a single instance for
	 * any application (Singleton).
	 * 
	 * @return Returns the instance of DAO.
	 * @throws PersistenceException Occurrence of any problems in creating of the
	 *                              DAO.
	 */
	public static synchronized InmetStationDAO getInstanceOf(String logClientName, Level logLevel)
			throws PersistenceException {
		if (InmetStationDAO.instance == null) {
			InmetStationDAO.instance = new InmetStationDAO(logClientName, logLevel);
		}
		return InmetStationDAO.instance;
	}

	/**
	 * Method to retrieve the instance of DAO. This class has a single instance for
	 * any application (Singleton).<br>
	 * To use this method, it is necessary that the DAO instance has already been
	 * created by executing the getInstanceOf(String logClientName, Level logLevel)
	 * method.
	 * 
	 * @return Returns the instance of DAO.
	 * @throws PersistenceException Occurrence of any problems in retrieving of the
	 *                              DAO instance.
	 */
	public static synchronized InmetStationDAO getInstanceOf() throws PersistenceException {
		return InmetStationDAO.getInstanceOf(InmetStationDAO.class.getSimpleName(), LOG_DEFAULT_LEVEL);
	}

	@Override
	public InmetStationDAO save(InmetStationEntity entity) throws PersistenceException {

		// validate entity
		Long id = entity != null ? entity.getId() : null;

		// saving moduleAddress relationship with module address entity
//		this.saveStationRelationship(entity.getStation());

		// save ou update the entity
		id = super.save(//
				entity.getId() //
				, "INSERT INTO " + TABLE_INMET_STATION + "(" + //
						"code," + //
						"latitude," + //
						"longitude," + //
						"city," + //
						"state," + //
						"start_date)" + //
						"VALUES(" + //
						"'" + entity.getCode() + "'" + "," + //
						+entity.getLatitude() + "," + //
						+entity.getLongitude() + "," + //
						"'" + entity.getCity() + "'" + "," + //
						"'" + entity.getState() + "'" + "," + //
						"'" + entity.getStartDate() + "'" + //
						")" + ";",
				"UPDATE " + TABLE_INMET_STATION + " SET " //
						+ "code=" + "'" + entity.getCode() + "'" + "," //
						+ "latitude=" + entity.getLatitude() + "," //
						+ "longitude=" + entity.getLongitude() + "," //
						+ "city=" + "'" + entity.getCity() + "'" + "," //
						+ "state=" + "'" + entity.getState() + "'" + ","//
						+ "start_date=" + "'" + entity.getStartDate() + "'" //
						+ "WHERE id=" + entity.getId() //
						+ ";");

		// return DAO instance
		return this;
	}

	@Override
	public InmetStationDAO remove(Long id) throws PersistenceException {

		// verifying that the id is valid
		if (id == null || id == 0) {
			throw this.error(NetworkUtil.getLocalIpAddress(), MessageEnum.GENERIC_DAO_ERROR_REMOVE,
					this.getClass().getSimpleName(), "remove", null, null, true, NetworkUtil.getLocalIpAddress(),
					this.getDAODescriptor(), String.valueOf(id));
		}

		try {
			// retrienving id for station relationship
//			InmetStationEntity station = this.find(id).getStation();

			// removing entity
			super.remove(id, "DELETE FROM " + TABLE_INMET_STATION + " WHERE id=" + id + ";");

			// removing remotesModulesAddresses relationship with module address entity
//			this.removeStationRelationship(station.getId());

		} catch (PersistenceException e) {
			throw (e);
		}

		// return DAO instance
		return this;
	}

	@Override
	public InmetStationEntity find(Long id) throws PersistenceException {
		return super.find(id, "SELECT * FROM " + TABLE_INMET_STATION + " WHERE id=" + id + ";");
	}

	@Override
	public List<InmetStationEntity> list() throws PersistenceException {
		return super.list("SELECT * FROM " + TABLE_INMET_STATION + ";");
	}

	@Override
	public InmetStationDAO init() throws PersistenceException {

		// initializing variables
		List<String> queries = new ArrayList<String>();

		// SQL for entity table create
		queries.add(//
				"CREATE TABLE IF NOT EXISTS public." + TABLE_INMET_STATION + //
						"(" + //
						"id bigserial NOT NULL," + //
						"id_city bigserial NOT NULL REFERENCES " + TABLE_INMET_CITY + "(id)," + //
						"code text NOT NULL," + //
						"start_date date NOT NULL," + //
						"PRIMARY KEY (id)" + //
						");"//
		);

		super.init(queries);
		
		List<InmetStationEntity> entities = this.list();
		if(entities.size() <= 0) {
			queries.add("INSERT INTO station(id_city,code,start_date) " //
					+ "VALUES (298,'A422','21/07/2008'),\r\n" + //
					"(160,'A360','22/04/2009'),\r\n" + //
					"(345,'A657','25/09/2011'),\r\n" + //
					"(26,'A908','16/12/2006'),\r\n" + //
					"(424,'A756','15/08/2010'),\r\n" + //
					"(176,'A045','02/10/2008'),\r\n" + //
					"(358,'A 549','09/09/2007'),\r\n" + //
					"(359,'A534','05/08/2007'),\r\n" + //
					"(346,'A617','25/10/2006'),\r\n" + //
					"(515,'A826','29/09/2006'),\r\n" + //
					"(347,'A615','02/11/2006'),\r\n" + //
					"(69,'A053','01/04/2016'),\r\n" + //
					"(360,'A508','09/12/2002'),\r\n" + //
					"(27,'A924','23/05/2007'),\r\n" + //
					"(89,'A253','25/10/2018'),\r\n" + //
					"(28,'A909','22/09/2011'),\r\n" + //
					"(1,'A024','02/05/2007'),\r\n" + //
					"(121,'A223','03/06/2008'),\r\n" + //
					"(29,'A934','29/01/2008'),\r\n" + //
					"(138,'A336','17/11/2007'),\r\n" + //
					"(425,'A750','12/06/2008'),\r\n" + 
					"(299,'A434','11/07/2008'),\r\n" + //
					"(426,'S701','09/04/2018'),\r\n" + //
					"(139,'A377','14/11/2019'),\r\n" + //
					"(490,'A628','25/08/2017'),\r\n" + //
					"(30,'A910','24/10/2006'),\r\n" + //
					"(230,'A340','14/11/2007'),\r\n" + //
					"(275,'A113','19/07/2008'),\r\n" + //
					"(427,'A719','01/11/2006'),\r\n" + //
					"(181,'A409','12/02/2003'),\r\n" + //
					"(361,'A566','21/05/2017'),\r\n" + //
					"(2,'A013','13/07/2007'),\r\n" + //
					"(70,'A054','19/08/2015'),\r\n" + //
					"(71,'A021','26/01/2007'),\r\n" + //
					"(72,'A044','12/03/2009'),\r\n" + //
					"(428,'S702','13/04/2018'),\r\n" + //
					"(559,'A867','28/09/2008'),\r\n" + //
					"(268,'A353','27/04/2008'),\r\n" + //
					"(362,'A505','19/12/2002'),\r\n" + //
					"(247,'A309','20/11/2004'),\r\n" + //
					"(238,'A310','16/11/2004'),\r\n" + //
					"(65,'A940','18/07/2008'),\r\n" + //
					"(188,'A736','15/11/2007'),\r\n" + //
					"(491,'A606','22/09/2006'),\r\n" + //
					"(276,'A120','17/04/2008'),\r\n" + //
					"(189,'A725','22/09/2006'),\r\n" + //
					"(122,'A220','09/07/2008'),\r\n" + //
					"(516,'A827','04/01/2007'),\r\n" + //
					"(140,'A375','23/03/2018'),\r\n" + //
					"(123,'A204','26/10/2007'),\r\n" + //
					"(363,'A565','22/11/2016'),\r\n" + //
					"(364,'A502','05/12/2002'),\r\n" + //
					"(161,'A315','31/05/2007'),\r\n" + //
					"(277,'A128','19/04/2008'),\r\n" + //
					"(300,'A429','12/05/2008'),\r\n" + //
					"(190,'A741','28/04/2008'),\r\n" + //
					"(124,'A221','06/03/2008'),\r\n" + //
					"(191,'A746','04/07/2008'),\r\n" + //
					"(301,'A402','20/12/2001'),\r\n" + //
					"(192,'A748','19/06/2010'),\r\n" + //
					"(193,'A755','23/03/2011'),\r\n" + //
					"(429,'A759','21/03/2013'),\r\n" + //
					"(194,'A705','30/08/2001'),\r\n" + //
					"(195,'A764','27/11/2016'),\r\n" + //
					"(430,'A757','09/08/2011'),\r\n" + //
					"(90,'A201','20/01/2003'),\r\n" + //
					"(302,'A447','02/07/2009'),\r\n" + //
					"(365,'F501','01/10/2014'),\r\n" + //
					"(366,'A521','10/10/2006'),\r\n" + //
					"(517,'A840','01/12/2006'),\r\n" + //
					"(196,'A765','01/02/2017'),\r\n" + //
					"(278,'A110','15/07/2008'),\r\n" + //
					"(303,'A418','18/05/2007'),\r\n" + //
					"(141,'A326','17/07/2007'),\r\n" + //
					"(91,'A226','11/03/2008'),\r\n" + //
					"(197,'A744','20/12/2017'),\r\n" + //
					"(431,'S705','06/04/2018'),\r\n" + //
					"(177,'A001','07/05/2000'),\r\n" + //
					"(178,'A042','19/07/2017'),\r\n" + //
					"(182,'A421','17/07/2008'),\r\n" + //
					"(92,'A228','21/10/2017'),\r\n" + //
					"(304,'A433','28/04/2008'),\r\n" + //
					"(125,'A238','11/09/2008'),\r\n" + //
					"(305,'A432','15/05/2008'),\r\n" + //
					"(367,'A544','19/06/2007'),\r\n" + //
					"(432,'S706','06/03/2018'),\r\n" + //
					"(239,'A348','28/02/2008'),\r\n" + //
					"(248,'A329','04/09/2007'),\r\n" + //
					"(560,'A859','19/03/2008'),\r\n" + //
					"(518,'A812','22/06/2006'),\r\n" + //
					"(31,'A941','30/03/2012'),\r\n" + //
					"(198,'A769','20/10/2017'),\r\n" + //
					"(66,'A939','20/07/2008'),\r\n" + //
					"(3,'A023','21/05/2007'),\r\n" + //
					"(231,'A316','07/01/2007'),\r\n" + //
					"(232,'A344','08/05/2008'),\r\n" + //
					"(368,'A530','28/11/2006'),\r\n" + //
					"(519,'A838','12/12/2006'),\r\n" + //
					"(240,'A352','04/05/2008'),\r\n" + //
					"(520,'A897','24/11/2016'),\r\n" + //
					"(492,'A604','20/11/2002'),\r\n" + //
					"(93,'A236','20/06/2008'),\r\n" + //
					"(464,'B803','04/08/2016'),\r\n" + //
					"(241,'A313','22/12/2006'),\r\n" + //
					"(369,'A519','14/07/2003'),\r\n" + //
					"(521,'A884','29/11/2013'),\r\n" + //
					"(433,'A702','11/09/2001'),\r\n" + //
					"(142,'A376','23/11/2018'),\r\n" + //
					"(32,'A905','12/12/2012'),\r\n" + //
					"(33,'A912','21/11/2006'),\r\n" + //
					"(494,'A620','13/06/2008'),\r\n" + //
					"(199,'A706','14/03/2002'),\r\n" + //
					"(493,'A607','22/09/2006'),\r\n" + //
					"(73,'A043','29/10/2012'),\r\n" + //
					"(561,'A898','15/02/2019'),\r\n" + //
					"(162,'A347','07/03/2008'),\r\n" + //
					"(522,'A879','23/08/2008'),\r\n" + //
					"(523,'A811','24/01/2007'),\r\n" + //
					"(143,'A365','12/06/2010'),\r\n" + //
					"(524,'A887','18/07/2019'),\r\n" + //
					"(370,'A541','02/09/2007'),\r\n" + //
					"(94,'A248','18/04/2011'),\r\n" + //
					"(144,'A337','10/11/2007'),\r\n" + //
					"(371,'A554','23/05/2007'),\r\n" + //
					"(306,'A405','20/12/2002'),\r\n" + //
					"(183,'A420','28/03/2008'),\r\n" + //
					"(34,'A926','10/04/2008'),\r\n" + //
					"(495,'A629','11/10/2018'),\r\n" + //
					"(126,'A205','04/12/2007'),\r\n" + //
					"(249,'A341','21/11/2007'),\r\n" + //
					"(200,'A738','28/06/2007'),\r\n" + //
					"(434,'A742','08/03/2008'),\r\n" + //
					"(95,'A202','24/01/2003'),\r\n" + //
					"(145,'A361','20/04/2009'),\r\n" + //
					"(465,'A819','09/07/2006'),\r\n" + //
					"(4,'A034','31/01/2008'),\r\n" + //
					"(127,'A237','13/07/2008'),\r\n" + //
					"(372,'A548','22/06/2007'),\r\n" + //
					"(435,'A730','19/12/2006'),\r\n" + //
					"(128,'A206','17/09/2008'),\r\n" + //
					"(562,'A895','18/02/2019'),\r\n" + //
					"(466,'A869','10/03/2008'),\r\n" + //
					"(467,'A876','16/05/2008'),\r\n" + //
					"(279,'A117','12/04/2008'),\r\n" + //
					"(129,'A222','03/06/2008'),\r\n" + //
					"(74,'A049','12/11/2016'),\r\n" + //
					"(468,'B806','28/05/2016'),\r\n" + //
					"(35,'A913','28/11/2006'),\r\n" + //
					"(373,'A520','16/07/2006'),\r\n" + //
					"(96,'A241','04/09/2008'),\r\n" + //
					"(307,'A431','07/04/2008'),\r\n" + //
					"(374,'A557','17/10/2012'),\r\n" + //
					"(146,'A374','28/03/2018'),\r\n" + //
					"(308,'A416','09/11/2007'),\r\n" + //
					"(436,'A724','27/10/2006'),\r\n" + //
					"(269,'A355','06/09/2008'),\r\n" + //
					"(437,'A760','04/12/2012'),\r\n" + //
					"(36,'A919','27/05/2007'),\r\n" + //
					"(438,'A720','07/11/2006'),\r\n" + //
					"(163,'A342','11/12/2008'),\r\n" + //
					"(5,'A036','13/12/2007'),\r\n" + //
					"(5,'A056','25/01/2018'),\r\n" + //
					"(525,'A853','31/05/2007'),\r\n" + //
					"(309,'A406','19/01/2003'),\r\n" + //
					"(261,'A108','14/05/2015'),\r\n" + //
					"(37,'A901','07/12/2002'),\r\n" + //
					"(310,'A448','20/08/2015'),\r\n" + //
					"(469,'A807','28/01/2003'),\r\n" + //
					"(563,'A860','03/03/2008'),\r\n" + //
					"(375,'A538','19/12/2006'),\r\n" + //
					"(311,'A443','15/07/2008'),\r\n" + //
					"(470,'A849','08/03/2008'),\r\n" + //
					"(376,'A537','05/06/2006'),\r\n" + //
					"(75,'A038','30/08/2008'),\r\n" + //
					"(564,'A848','31/05/2008'),\r\n" + //
					"(377,'A564','26/10/2017'),\r\n" + //
					"(471,'A843','29/03/2007'),\r\n" + //
					"(97,'A252','08/03/2018'),\r\n" + //
					"(526,'A881','23/04/2010'),\r\n" + //
					"(378,'A536','01/06/2007'),\r\n" + //
					"(439,'A721','21/10/2006'),\r\n" + //
					"(201,'A762','03/11/2016'),\r\n" + //
					"(496,'A603','21/10/2002'),\r\n" + //
					"(348,'A631','17/03/2017'),\r\n" + //
					"(7,'A029','26/08/2017'),\r\n" + //
					"(280,'A109','31/08/2012'),\r\n" + //
					"(527,'A893','15/03/2018'),\r\n" + //
					"(262,'A140','25/09/2009'),\r\n" + //
					"(528,'A828','25/11/2006'),\r\n" + //
					"(130,'A224','27/02/2008'),\r\n" + //
					"(312,'A442','31/03/2008'),\r\n" + //
					"(131,'A218','22/11/2008'),\r\n" + //
					"(132,'A217','28/11/2008'),\r\n" + //
					"(263,'A138','24/09/2009'),\r\n" + //
					"(313,'A413','26/05/2007'),\r\n" + //
					"(250,'A351','15/09/2008'),\r\n" + //
					"(379,'A535','27/06/2008'),\r\n" + //
					"(147,'A311','18/11/2004'),\r\n" + //
					"(565,'A806','22/01/2003'),\r\n" + //
					"(380,'A524','17/08/2006'),\r\n" + //
					"(314,'A452','02/06/2016'),\r\n" + //
					"(76,'A039','27/04/2008'),\r\n" + //
					"(164,'A305','18/02/2003'),\r\n" + //
					"(472,'A846','15/02/2008'),\r\n" + //
					"(202,'A708','10/12/2002'),\r\n" + //
					"(529,'A854','13/12/2007'),\r\n" + //
					"(179,'A046','01/10/2014'),\r\n" + //
					"(251,'A322','08/07/2007'),\r\n" + //
					"(38,'A930','06/06/2008'),\r\n" + //
					"(473,'A875','10/04/2008'),\r\n" + //
					"(148,'A364','16/05/2009'),\r\n" + //
					"(8,'A022','02/06/2007'),\r\n" + //
					"(9,'A002','30/05/2001'),\r\n" + //
					"(10,'A014','16/07/2007'),\r\n" + //
					"(474,'A825','19/10/2006'),\r\n" + //
					"(381,'A532','29/05/2007'),\r\n" + //
					"(133,'A207','10/09/2008'),\r\n" + //
					"(315,'A426','24/04/2008'),\r\n" + //
					"(382,'A533','02/06/2007'),\r\n" + //
					"(165,'A314','26/05/2007'),\r\n" + //
					"(39,'A906','20/12/2002'),\r\n" + //
					"(383,'A546','11/07/2007'),\r\n" + //
					"(40,'A932','25/01/2008'),\r\n" + //
					"(77,'A019','20/12/2006'),\r\n" + //
					"(281,'A112','25/04/2008'),\r\n" + //
					"(252,'A349','14/10/2008'),\r\n" + //
					"(384,'A555','07/06/2008'),\r\n" + //
					"(530,'A883','13/12/2012'),\r\n" + //
					"(203,'A737','09/11/2007'),\r\n" + //
					"(316,'A439','28/04/2008'),\r\n" + //
					"(475,'A824','15/11/2006'),\r\n" + //
					"(204,'A712','19/07/2006'),\r\n" + //
					"(440,'S709','14/04/2018'),\r\n" + //
					"(166,'A319','30/05/2007'),\r\n" + //
					"(317,'A410','25/01/2003'),\r\n" + //
					"(134,'A225','01/03/2008'),\r\n" + //
					"(476,'A823','16/10/2006'),\r\n" + //
					"(566,'A817','02/07/2006'),\r\n" + //
					"(443,'A709','10/02/2003'),\r\n" + //
					"(233,'A372','08/11/2017'),\r\n" + //
					"(318,'A445','30/06/2009'),\r\n" + //
					"(11,'A028','24/06/2013'),\r\n" + //
					"(319,'A424','31/03/2008'),\r\n" + //
					"(184,'A451','24/04/2017'),\r\n" + //
					"(185,'A417','23/05/2007'),\r\n" + //
					"(320,'A408','29/01/2003'),\r\n" + //
					"(282,'A121','17/04/2008'),\r\n" + //
					"(98,'A231','17/02/2008'),\r\n" + //
					"(567,'A868','24/06/2010'),\r\n" + //
					"(321,'A455','28/05/2016'),\r\n" + //
					"(385,'A550','05/09/2007'),\r\n" + //
					"(12,'A015','03/02/2007'),\r\n" + //
					"(322,'A446','25/06/2009'),\r\n" + //
					"(205,'A714','25/07/2006'),\r\n" + //
					"(167,'A359','05/09/2008'),\r\n" + //
					"(206,'A739','13/11/2007'),\r\n" + //
					"(568,'A851','06/06/2007'),\r\n" + //
					"(441,'S710','26/02/2018'),\r\n" + //
					"(242,'A373','03/11/2017'),\r\n" + //
					"(442,'A752','31/05/2008'),\r\n" + //
					"(497,'A635','01/09/2017'),\r\n" + //
					"(294,'A251','24/08/2017'),\r\n" + //
					"(41,'A933','14/08/2008'),\r\n" + //
					"(323,'A407','09/02/2003'),\r\n" + //
					"(386,'A512','11/05/2006'),\r\n" + //
					"(13,'A035','02/11/2007'),\r\n" + //
					"(569,'A863','05/03/2008'),\r\n" + //
					"(207,'A753','17/08/2008'),\r\n" + //
					"(477,'A818','12/07/2006'),\r\n" + //
					"(324,'A440','01/05/2008'),\r\n" + //
					"(531,'A836','09/01/2007'),\r\n" + //
					"(168,'A358','10/09/2008'),\r\n" + //
					"(169,'A339','10/11/2007'),\r\n" + //
					"(208,'A733','23/08/2007'),\r\n" + //
					"(387,'A563','19/11/2016'),\r\n" + //
					"(388,'A559','04/06/2016'),\r\n" + //
					"(478,'A871','28/02/2008'),\r\n" + //
					"(444,'A758','04/08/2011'),\r\n" + //
					"(14,'A016','24/05/2007'),\r\n" + //
					"(325,'A450','13/08/2015'),\r\n" + //
					"(570,'A841','19/09/2007'),\r\n" + //
					"(243,'A320','21/07/2007'),\r\n" + //
					"(389,'A553','07/07/2007'),\r\n" + //
					"(479,'A821','23/11/2006'),\r\n" + //
					"(209,'A735','04/09/2007'),\r\n" + //
					"(42,'A914','02/11/2006'),\r\n" + //
					"(43,'A920','01/12/2006'),\r\n" + //
					"(390,'A518','26/05/2007'),\r\n" + //
					"(445,'A749','18/06/2008'),\r\n" + //
					"(283,'A111','27/07/2008'),\r\n" + //
					"(78,'A055','15/11/2016'),\r\n" + //
					"(532,'A844','02/03/2007'),\r\n" + //
					"(572,'A866','31/05/2008'),\r\n" + //
					"(446,'S711','07/03/2018'),\r\n" + //
					"(571,'A865','06/11/2014'),\r\n" + //
					"(480,'B804','07/08/2016'),\r\n" + //
					"(326,'A425','05/04/2008'),\r\n" + //
					"(349,'A614','27/10/2006'),\r\n" + //
					"(210,'A727','20/09/2006'),\r\n" + //
					"(327,'A404','18/04/2002'),\r\n" + //
					"(15,'A012','21/10/2006'),\r\n" + //
					"(498,'A608','22/09/2006'),\r\n" + //
					"(328,'A412','03/02/2003'),\r\n" + //
					"(295,'A249','12/12/2013'),\r\n" + //
					"(234,'A317','06/01/2007'),\r\n" + //
					"(270,'A303','25/02/2003'),\r\n" + //
					"(391,'A567','21/07/2017'),\r\n" + //
					"(573,'A864','09/02/2009'),\r\n" + //
					"(284,'A119','10/04/2004'),\r\n" + //
					"(285,'A101','09/05/2000'),\r\n" + //
					"(392,'A556','25/09/2010'),\r\n" + //
					"(286,'A133','12/12/2011'),\r\n" + //
					"(393,'A540','01/08/2007'),\r\n" + //
					"(99,'A240','25/06/2009'),\r\n" + //
					"(447,'A731','14/12/2006'),\r\n" + //
					"(329,'A438','22/06/2008'),\r\n" + //
					"(481,'A820','18/11/2006'),\r\n" + //
					"(264,'A137','27/10/2009'),\r\n" + //
					"(394,'A531','01/12/2006'),\r\n" + //
					"(79,'A041','24/11/2012'),\r\n" + //
					"(350,'A632','20/03/2017'),\r\n" + //
					"(211,'A763','13/05/2017'),\r\n" + //
					"(482,'A835','21/11/2006'),\r\n" + //
					"(80,'A040','25/10/2012'),\r\n" + //
					"(287,'A122','22/04/2008'),\r\n" + //
					"(100,'A209','17/02/2008'),\r\n" + //
					"(101,'A246','28/09/2010'),\r\n" + //
					"(16,'A026','23/10/2007'),\r\n" + //
					"(448,'A722','02/11/2006'),\r\n" + //
					"(395,'A539','11/11/2007'),\r\n" + //
					"(396,'A526','26/06/2007'),\r\n" + //
					"(102,'A239','06/07/2012'),\r\n" + //
					"(17,'A032','06/06/2007'),\r\n" + //
					"(398,'A509','19/12/2004'),\r\n" + //
					"(244,'A334','22/08/2007'),\r\n" + //
					"(397,'A506','16/12/2002'),\r\n" + //
					"(170,'A332','24/08/2007'),\r\n" + //
					"(483,'A873','13/03/2008'),\r\n" + //
					"(18,'A003','30/05/2001'),\r\n" + //
					"(574,'A845','18/06/2007'),\r\n" + //
					"(235,'A318','22/05/2007'),\r\n" + //
					"(533,'A878','12/03/2008'),\r\n" + //
					"(399,'A517','28/08/2006'),\r\n" + //
					"(236,'A304','24/02/2003'),\r\n" + //
					"(449,'A717','03/08/2006'),\r\n" + //
					"(499,'A627','13/07/2018'),\r\n" + //
					"(186,'A453','24/03/2017'),\r\n" + //
					"(450,'S712','22/02/2018'),\r\n" + //
					"(484,'A842','08/02/2007'),\r\n" + //
					"(500,'A624','18/09/2010'),\r\n" + //
					"(44,'A928','17/04/2008'),\r\n" + //
					"(485,'A822','20/12/2006'),\r\n" + //
					"(45,'A929','13/04/2008'),\r\n" + //
					"(351,'A623','23/06/2008'),\r\n" + //
					"(288,'A144','18/07/2019'),\r\n" + //
					"(575,'A816','20/09/2008'),\r\n" + //
					"(46,'A927','29/02/2008'),\r\n" + //
					"(103,'A235','23/07/2008'),\r\n" + //
					"(104,'A232','05/07/2012'),\r\n" + //
					"(149,'A354','22/07/2008'),\r\n" + //
					"(296,'A242','11/09/2008'),\r\n" + //
					"(400,'A570','20/10/2017'),\r\n" + //
					"(253,'A366','11/08/2010'),\r\n" + //
					"(212,'A716','30/08/2006'),\r\n" + //
					"(401,'A513','28/07/2006'),\r\n" + //
					"(105,'A210','27/02/2008'),\r\n" + //
					"(254,'A357','04/09/2008'),\r\n" + //
					"(81,'A009','17/12/2004'),\r\n" + //
					"(534,'A856','27/02/2008'),\r\n" + //
					"(271,'A327','11/07/2007'),\r\n" + //
					"(272,'A323','14/07/2007'),\r\n" + //
					"(402,'A571','15/03/2008'),\r\n" + //
					"(106,'A212','18/10/2007'),\r\n" + //
					"(82,'A010','04/03/2005'),\r\n" + //
					"(451,'A710','13/11/2007'),\r\n" + //
					"(486,'A850','05/03/2008'),\r\n" + //
					"(47,'A915','19/12/2006'),\r\n" + //
					"(180,'A047','07/02/2017'),\r\n" + //
					"(501,'A619','06/12/2006'),\r\n" + //
					"(19,'A027','30/03/2008'),\r\n" + //
					"(289,'A123','10/04/2008'),\r\n" + //
					"(150,'A308','06/02/2003'),\r\n" + //
					"(265,'A102','05/08/2008'),\r\n" + //
					"(403,'A529','30/05/2007'),\r\n" + //
					"(535,'A839','27/11/2006'),\r\n" + //
					"(404,'A516','16/07/2006'),\r\n" + //
					"(245,'A321','21/07/2007'),\r\n" + //
					"(405,'A562','12/05/2017'),\r\n" + //
					"(406,'A523','22/08/2006'),\r\n" + //
					"(151,'A330','31/08/2007'),\r\n" + //
					"(83,'A020','23/01/2007'),\r\n" + //
					"(452,'S714','02/02/2018'),\r\n" + //
					"(84,'A018','01/12/2006'),\r\n" + //
					"(255,'A307','21/02/2003'),\r\n" + //
					"(502,'A610','22/10/2006'),\r\n" + //
					"(330,'A430','03/05/2008'),\r\n" + //
					"(152,'A343','12/12/2008'),\r\n" + //
					"(331,'A449','01/04/2016'),\r\n" + //
					"(213,'A726','26/09/2006'),\r\n" + //
					"(273,'A371','20/09/2017'),\r\n" + //
					"(407,'A545','04/07/2007'),\r\n" + //
					"(20,'A033','12/10/2007'),\r\n" + //
					"(153,'A335','31/08/2007'),\r\n" + //
					"(85,'A051','06/04/2016'),\r\n" + //
					"(107,'A211','14/02/2008'),\r\n" + //
					"(487,'A855','07/11/2007'),\r\n" + //
					"(187,'A419','03/04/2008'),\r\n" + //
					"(453,'A703','06/09/2001'),\r\n" + //
					"(48,'A937','31/01/2008'),\r\n" + //
					"(21,'A005','04/06/2001'),\r\n" + //
					"(536,'A801','18/09/2000'),\r\n" + //
					"(108,'A245','19/06/2019'),\r\n" + //
					"(49,'A935','27/02/2008'),\r\n" + //
					"(297,'A244','17/09/2008'),\r\n" + //
					"(454,'A723','24/10/2006'),\r\n" + //
					"(332,'A427','10/07/2008'),\r\n" + //
					"(67,'A925','11/07/2007'),\r\n" + //
					"(266,'A136','29/10/2009'),\r\n" + //
					"(22,'A017','18/04/2007'),\r\n" + //
					"(214,'A747','20/04/2008'),\r\n" + //
					"(290,'A126','19/04/2008'),\r\n" + //
					"(352,'A622','18/06/2008'),\r\n" + //
					"(215,'A707','03/02/2003'),\r\n" + //
					"(50,'A923','26/10/2007'),\r\n" + //
					"(537,'A831','17/10/2007'),\r\n" + //
					"(333,'A436','23/05/2008'),\r\n" + //
					"(51,'A916','20/07/2007'),\r\n" + //
					"(171,'A369','20/03/2018'),\r\n" + //
					"(172,'A325','09/07/2007'),\r\n" + //
					"(216,'A718','02/09/2006'),\r\n" + //
					"(576,'A870','01/06/2016'),\r\n" + //
					"(256,'A301','22/12/2004'),\r\n" + //
					"(109,'A254','11/07/2019'),\r\n" + //
					"(217,'A766','09/02/2017'),\r\n" + //
					"(334,'A423','26/03/2008'),\r\n" + //
					"(503,'A609','29/09/2006'),\r\n" + //
					"(455,'S715','18/01/2018'),\r\n" + //
					"(335,'A458','20/09/2018'),\r\n" + //
					"(267,'A104','11/07/2008'),\r\n" + //
					"(456,'A743','26/06/2008'),\r\n" + //
					"(504,'A626','03/06/2016'),\r\n" + //
					"(505,'A652','18/05/2007'),\r\n" + //
					"(506,'A636','10/08/2017'),\r\n" + //
					"(507,'A602','07/10/2002'),\r\n" + //
					"(508,'A621','13/04/2007'),\r\n" + //
					"(577,'A861','06/03/2008'),\r\n" + //
					"(538,'A802','06/09/2001'),\r\n" + //
					"(578,'A862','22/03/2008'),\r\n" + //
					"(539,'A813','01/10/2006'),\r\n" + //
					"(408,'A551','17/11/2007'),\r\n" + //
					"(86,'A050','03/08/2016'),\r\n" + //
					"(291,'A125','26/06/2008'),\r\n" + //
					"(23,'A025','17/05/2007'),\r\n" + //
					"(110,'A214','17/04/2008'),\r\n" + //
					"(52,'A907','17/11/2003'),\r\n" + //
					"(53,'A944','30/05/2019'),\r\n" + //
					"(409,'A525','18/08/2006'),\r\n" + //
					"(257,'A370','15/09/2017'),\r\n" + //
					"(410,'A552','14/07/2007'),\r\n" + //
					"(111,'A215','14/06/2008'),\r\n" + //
					"(54,'A936','28/01/2008'),\r\n" + //
					"(336,'A401','13/05/2000'),\r\n" + //
					"(337,'A456','09/03/2018'),\r\n" + //
					"(237,'A367','17/08/2010'),\r\n" + //
					"(87,'A048','30/07/2016'),\r\n" + //
					"(540,'A803','03/09/2001'),\r\n" + //
					"(509,'A630','16/11/2012'),\r\n" + //
					"(338,'A415','28/05/2007'),\r\n" + //
					"(457,'S716','19/04/2018'),\r\n" + //
					"(542,'A810','15/11/2006'),\r\n" + //
					"(88,'A052','14/08/2015'),\r\n" + //
					"(353,'A613','09/08/2007'),\r\n" + //
					"(543,'A899','15/03/2008'),\r\n" + //
					"(112,'A233','30/05/2008'),\r\n" + //
					"(541,'A804','21/11/2001'),\r\n" + //
					"(113,'A250','02/09/2015'),\r\n" + //
					"(544,'A833','05/02/2009'),\r\n" + //
					"(55,'A931','31/05/2008'),\r\n" + //
					"(545,'A805','05/12/2001'),\r\n" + //
					"(546,'A830','21/07/2007'),\r\n" + //
					"(218,'A711','05/09/2006'),\r\n" + //
					"(56,'A921','18/10/2007'),\r\n" + //
					"(114,'A216','16/11/2016'),\r\n" + //
					"(547,'A832','12/10/2007'),\r\n" + //
					"(292,'A134','31/08/2011'),\r\n" + //
					"(458,'A732','16/12/2006'),\r\n" + //
					"(246,'A333','06/11/2007'),\r\n" + //
					"(411,'A514','09/06/2006'),\r\n" + //
					"(154,'A331','26/08/2007'),\r\n" + //
					"(579,'A815','12/04/2008'),\r\n" + //
					"(57,'A903','25/02/2003'),\r\n" + //
					"(58,'A942','19/02/2019'),\r\n" + //
					"(548,'A829','26/10/2006'),\r\n" + //
					"(135,'A203','29/01/2003'),\r\n" + //
					"(219,'A740','01/11/2007'),\r\n" + //
					"(274,'A356','08/09/2008'),\r\n" + //
					"(549,'A852','25/07/2007'),\r\n" + //
					"(354,'A616','26/10/2006'),\r\n" + //
					"(488,'A874','18/04/2011'),\r\n" + //
					"(220,'A715','16/08/2006'),\r\n" + //
					"(24,'A031','30/06/2017'),\r\n" + //
					"(580,'A857','12/03/2008'),\r\n" + //
					"(222,'A771','14/03/2018'),\r\n" + //
					"(221,'A701','25/07/2006'),\r\n" + //
					"(155,'A362','20/05/2009'),\r\n" + //
					"(258,'A302','02/11/2003'),\r\n" + //
					"(156,'A345','27/02/2008'),\r\n" + //
					"(412,'A547','30/06/2007'),\r\n" + //
					"(223,'A767','26/10/2017'),\r\n" + //
					"(413,'A561','17/08/2015'),\r\n" + //
					"(25,'A011','14/07/2006'),\r\n" + //
					"(25,'A770','03/07/2019'),\r\n" + //
					"(550,'A889','06/04/2016'),\r\n" + //
					"(59,'A911','20/10/2017'),\r\n" + //
					"(510,'A667','02/08/2015'),\r\n" + //
					"(459,'S717','06/04/2018'),\r\n" + //
					"(339,'A428','27/03/2008'),\r\n" + //
					"(551,'A894','06/04/2016'),\r\n" + //
					"(511,'A601','07/05/2000'),\r\n" + //
					"(414,'A522','21/08/2006'),\r\n" + //
					"(115,'A230','03/09/2008'),\r\n" + //
					"(60,'A943','29/03/2019'),\r\n" + //
					"(259,'A350','09/07/2008'),\r\n" + //
					"(340,'A441','09/05/2008'),\r\n" + //
					"(415,'A569','10/04/2016'),\r\n" + //
					"(460,'A751','06/06/2008'),\r\n" + //
					"(461,'A754','30/09/2008'),\r\n" + //
					"(512,'A659','28/08/2015'),\r\n" + //
					"(61,'A917','29/10/2006'),\r\n" + //
					"(173,'A306','12/02/2003'),\r\n" + //
					"(552,'A837','27/02/2008'),\r\n" + //
					"(462,'A761','30/11/2012'),\r\n" + //
					"(225,'A713','21/08/2006'),\r\n" + //
					"(62,'A904','16/12/2002'),\r\n" + //
					"(116,'A227','27/04/2008'),\r\n" + //
					"(260,'A328','09/03/2008'),\r\n" + //
					"(63,'A902','12/10/2002'),\r\n" + //
					"(174,'A324','12/07/2007'),\r\n" + //
					"(226,'A728','20/12/2006'),\r\n" + //
					"(416,'A527','25/08/2006'),\r\n" + //
					"(157,'A312','24/11/2004'),\r\n" + //
					"(513,'A618','01/11/2006'),\r\n" + //
					"(553,'A882','04/10/2012'),\r\n" + //
					"(175,'A368','14/03/2018'),\r\n" + //
					"(417,'A511','22/02/2006'),\r\n" + //
					"(117,'A213','14/10/2007'),\r\n" + //
					"(554,'A808','01/06/2006'),\r\n" + //
					"(555,'A834','09/03/2008'),\r\n" + //
					"(463,'A704','03/09/2001'),\r\n" + //
					"(418,'A528','28/08/2006'),\r\n" + //
					"(514,'A625','07/06/2016'),\r\n" + //
					"(118,'A234','18/07/2008'),\r\n" + //
					"(119,'A229','01/03/2008'),\r\n" + //
					"(227,'A768','12/05/2017'),\r\n" + //
					"(556,'A886','11/08/2016'),\r\n" + //
					"(136,'A219','10/06/2008'),\r\n" + //
					"(341,'A435','20/05/2008'),\r\n" + //
					"(419,'A568','18/05/2017'),\r\n" + //
					"(420,'A507','14/12/2002'),\r\n" + //
					"(342,'A437','25/06/2008'),\r\n" + //
					"(421,'A542','15/06/2007'),\r\n" + //
					"(293,'A124','17/04/2008'),\r\n" + //
					"(158,'A346','06/03/2008'),\r\n" + //
					"(557,'A809','25/09/2006'),\r\n" + //
					"(581,'A814','28/05/2008'),\r\n" + //
					"(558,'A880','26/04/2008'),\r\n" + //
					"(343,'A444','29/06/2009'),\r\n" + //
					"(159,'A363','18/04/2009'),\r\n" + //
					"(228,'A734','28/08/2007'),\r\n" + //
					"(422,'A515','13/07/2006'),\r\n" + //
					"(355,'A633','11/02/2017'),\r\n" + //
					"(489,'A872','15/04/2011'),\r\n" + //
					"(423,'A510','15/09/2005'),\r\n" + //
					"(64,'A922','24/11/2006'),\r\n" + //
					"(356,'A634','15/02/2017'),\r\n" + //
					"(68,'A938','26/08/2008'),\r\n" + //
					"(357,'A612','31/10/2006'),\r\n" + //
					"(344,'A414','01/06/2007'),\r\n" + //
					"(229,'A729','07/12/2006'),\r\n" + //
					"(582,'A858','15/03/2008'),\r\n" + //
					"(120,'A247','11/09/2016'),\r\n" + //
					"(137,'A255','18/09/2019');");
			
			super.init(queries);
		}
		return this;
	}

	@Override
	protected InmetStationEntity getEntity(ResultSet queryResult) throws PersistenceException {

		Long id = null;
		try {
			// retrieving the attributes
			id = queryResult.getObject("id") != null ? queryResult.getLong("id") : null;
			
			// Recovering relationship
			Long idCity = queryResult.getLong("id_city");
			CityEntily cityEntily = this.getStationRelationship(idCity);

			// creating new entity with attributes retrieved from database
			return new InmetStationEntity( //
					queryResult.getLong("id"), //
					queryResult.getString("code"), //
					cityEntily, //
					TimeUtil.stringToLocalDate(queryResult.getString("start_date"))//
			); //

		} catch (Throwable e) {
			throw this.error(NetworkUtil.getLocalIpAddress(), MessageEnum.GENERIC_DAO_ERROR_GET_ENTITY,
					this.getClass().getSimpleName(), "getEntity", e.getMessage(), null, true,
					NetworkUtil.getLocalIpAddress(), this.getDAODescriptor(), String.valueOf(id));
		}
	}

	/**
	 * Saves the module address entity associated with the moduleAddress
	 * relationship (1-1).
	 * 
	 * @param entity Relationship entity to be saved.
	 * @return Returns the instance of DAO.
	 * @throws PersistenceException Occurrence of any problems in saving of the
	 *                              relationship.
	 */
	private InmetStationDAO saveStationRelationship(CityEntily entity) throws PersistenceException {
		if (entity != null) {
			CityDataDAO.getInstanceOf().save(entity);
		}
		return this;
	}

	/**
	 * Removes the module address entity associated with the moduleAddress
	 * relationship (1-1) according to the informed identification (ID).
	 * 
	 * @param entityId Identifier (ID) of the entity associated with the
	 *                 moduleAddress relationship.
	 * @return Returns the instance of DAO.
	 */
	private InmetStationDAO removeStationRelationship(Long entityId) {
		try {
			CityDataDAO.getInstanceOf().remove(entityId);
		} catch (Throwable e) {
		}
		return this;
	}

	/**
	 * Retrieves the module address entity associated with the moduleAddress
	 * relationship (1-1) according to the informed identification (ID).
	 * 
	 * @param entityId Identification of the entity (ID) of the relationship.
	 * @return Returns the instance of relationship entity.
	 * @throws PersistenceException Occurrence of any problems in retrieving of the
	 *                              relationship.
	 */
	private CityEntily getStationRelationship(Long entityId) throws PersistenceException {
		if (entityId != null) {
			return CityDataDAO.getInstanceOf().find(entityId);
		}
		return null;
	}

}
